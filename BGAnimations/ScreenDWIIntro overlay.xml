<ActorFrame OnCommand="%function(self)
	DWI_slwalk = 1;
end"><children>
		<Layer
			Font="_gpscore P1"
			Text="0"
			InitCommand="x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y-100000000000;draworder,90"
			OnCommand="%function(self)
				self:queuecommand('SongCheck')
			end"
			SongCheckCommand="%function(self)
			self:settext( table.getn(SONGMAN:GetAllSongs()) )
			self:diffusealpha(0)
				local Profile = PROFILEMAN:GetMachineProfile():GetSaved()

				if not Profile.DWISongs then
					Profile.DWISongs = 0;
					Profile.DWIAnnouncer = false;
					Profile.DWIBeatNum = false;
					Profile.DWIPercentageShow = false;
					Profile.DWIRandomCompany = false;
					Profile.DWIToggleDemonstration = false;
					PROFILEMAN:SaveMachineProfile()
				end
			end"
			NewSongWarningCommand="%function(self)
			SCREENMAN:SetNewScreen('ScreenNewSongs')
			end"
			SendToTitleScreenCommand="%function(self)
			SCREENMAN:SetNewScreen('ScreenTitleMenu')
			end"
		/>

		<LAER Font="Common Normal" Text="" OnCommand="x,20;y,120;zoom,0.55;shadowlength,0;diffuse,#efef9f;horizalign,left;queuecommand,Hardware"
			HardwareCommand="%function(self) self:settext('(starting)'); self:sleep(0.8); self:queuecommand('UpdateSongs') end"
			UpdateSongsCommand="%function(self)
			local DWI_songlist = SONGMAN:GetAllSongs()
			local Profile = PROFILEMAN:GetMachineProfile():GetSaved()
				if DWI_slwalk >= table.getn(DWI_songlist) then
					self:settext('(done)');
					if table.getn( DWI_songlist ) > Profile.DWISongs then
						self:sleep(0.25)
						self:queuecommand('NewSongWarning')
					else
						self:sleep(0.25)
						self:queuecommand('SendToTitleScreen')
					end
				else					
					self:settext('' ..DWI_GroupName(DWI_songlist[DWI_slwalk]).. '/' ..DWI_songlist[DWI_slwalk]:GetDisplayMainTitle() );
					DWI_slwalk = DWI_slwalk + 6;
					self:sleep( 0.01 + ( math.random(60,100) / 1000 ) );
					self:queuecommand('UpdateSongs');
				end
			end"
			NewSongWarningCommand="%function(self)
			SCREENMAN:SetNewScreen('ScreenNewSongs')
			end"
			SendToTitleScreenCommand="%function(self)
			SCREENMAN:SetNewScreen('ScreenTitleMenu')
			end"
			/>

		<LAER Font="Common Normal" Text="Please wait - Searching for files..." OnCommand="x,20;y,40;zoom,0.8;shadowlength,0;horizalign,left;" />
		<LAER Type="Quad" OnCommand="x,20;y,95;horizalign,left;zoomtowidth,SCREEN_WIDTH*0.95;zoomy,16;diffusetopedge,#0808ff;diffusebottomedge,#7878ff;cropright,1;queuecommand,Start" 
			StartCommand="%function(self)
			self:sleep(0.4);
			self:queuecommand('UpdateBar')
			end"
			UpdateBarCommand="%function(self)
			local DWI_songlist = SONGMAN:GetAllSongs()
			if DWI_slwalk >= table.getn(DWI_songlist) then
				self:cropright(0)
			else
				self:cropright(100 / ( (DWI_slwalk)  ) )
			end
			self:sleep( 0.01 + ( math.random(60,100) / 1000 ) );
			self:queuecommand('UpdateBar')
			end"
			/>
		<LAER File="@ThemeFile('LoadingSongBar')" OnCommand="x,20;y,95;shadowlength,0;horizalign,left;zoomtowidth,SCREEN_WIDTH*0.95" />
		<LAER Font="Common Normal" Text="Examining song folders..." OnCommand="x,20;y,70;zoom,0.6;diffuse,0.5,0.5,0.5,1;shadowlength,0;horizalign,left;" />

		<LAER Font="Common Normal" Text="" OnCommand="x,SCREEN_RIGHT-20;y,73;zoom,0.4;shadowlength,0;horizalign,right;diffuse,0.5,0.5,0.5,1;queuecommand,Hardware"
			HardwareCommand="%function(self) self:settext('Analizing folders and song contents'); self:sleep(0.8); self:queuecommand('UpdateSongs') end"
			UpdateSongsCommand="%function(self)
			local DWI_songlist = SONGMAN:GetAllSongs()
			local Profile = PROFILEMAN:GetMachineProfile():GetSaved()
				if DWI_slwalk >= table.getn(DWI_songlist) then
					self:settext( table.getn(DWI_songlist) ..' / '.. table.getn(DWI_songlist) );
					if table.getn( DWI_songlist ) > Profile.DWISongs then
						self:sleep(0.25)
						self:queuecommand('NewSongWarning')
					else
						self:sleep(0.25)
						self:queuecommand('SendToTitleScreen')
					end
				else					
					self:settext( DWI_slwalk ..' / '.. table.getn(DWI_songlist) );
					DWI_slwalk = DWI_slwalk + 6;
					self:sleep(0.01+(math.random(60,100)/1000));
					self:queuecommand('UpdateSongs');
				end
			end"
			NewSongWarningCommand="%function(self)
			local Profile = PROFILEMAN:GetMachineProfile():GetSaved()
			Profile.DWISongs = table.getn(SONGMAN:GetAllSongs());
			SCREENMAN:SetNewScreen('ScreenNewSongs')
			end"
			SendToTitleScreenCommand="%function(self)
			local Profile = PROFILEMAN:GetMachineProfile():GetSaved()
			Profile.DWISongs = table.getn(SONGMAN:GetAllSongs());
			SCREENMAN:SetNewScreen('ScreenTitleMenu')
			end"
			/>

	</children></ActorFrame>